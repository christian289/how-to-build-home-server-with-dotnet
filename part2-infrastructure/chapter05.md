# ì œ5ì¥: ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œì™€ ë„ë©”ì¸ ì„¤ì •

## ì™œ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œê°€ í•„ìš”í•œê°€?

### ì„œë¹„ìŠ¤ê°€ ëŠ˜ì–´ë‚˜ë©´ì„œ ê²ªëŠ” ì ‘ì† ê´€ë¦¬ì˜ ì•…ëª½

4ì¥ì—ì„œ Dockerë¡œ ì„œë¹„ìŠ¤ ì„¤ì¹˜ì™€ ê´€ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤. ì´ì œ ìƒˆë¡œìš´ ë¬¸ì œê°€ ì‹œì‘ë©ë‹ˆë‹¤: **ì–´ë–»ê²Œ ì´ ëª¨ë“  ì„œë¹„ìŠ¤ì— ì ‘ì†í•  ê²ƒì¸ê°€?**

#### 1ë‹¨ê³„: í¬íŠ¸ ì§ì ‘ ì ‘ì†ì˜ ì‹œì‘ (ì„œë¹„ìŠ¤ 1-3ê°œ)

ì²˜ìŒì—ëŠ” ê°„ë‹¨í•©ë‹ˆë‹¤. ëª‡ ê°œ ì„œë¹„ìŠ¤ë§Œ ìš´ì˜í•  ë•Œ:

```
Portainer:   http://192.168.0.100:9000
PostgreSQL:  192.168.0.100:5432
Gitea:       http://192.168.0.100:3000
```

**ì´ ë‹¨ê³„ì—ì„œëŠ” ë¬¸ì œì—†ìŠµë‹ˆë‹¤**:
- í¬íŠ¸ 3ê°œ ì •ë„ëŠ” ì™¸ì›Œì§‘ë‹ˆë‹¤
- ê°œì¸ í”„ë¡œì íŠ¸ìš©ì´ë¼ ìƒê´€ì—†ìŠµë‹ˆë‹¤
- ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ì—ì„œë§Œ ì“°ë‹ˆ ë³´ì•ˆë„ ê´œì°®ìŠµë‹ˆë‹¤

#### 2ë‹¨ê³„: í¬íŠ¸ í˜¼ëˆ ì‹œì‘ (ì„œë¹„ìŠ¤ 5-10ê°œ)

**ì‹¤ì œë¡œ ê²ªëŠ” ë¬¸ì œ**:

```
Portainer:   :9000
Gitea:       :3000
Harbor:      :8080
Nexus:       :8081
Grafana:     :3001
Sentry:      :9090
Vault:       :8200
phpMyAdmin:  :8082
...
```

**íŒ€ ìƒí™© 1: ì˜¤ì „ 10ì‹œ, Slack ë©”ì‹œì§€ í­íƒ„**
```
íŒ€ì›A: "Nexus ì£¼ì†Œê°€ ë­ì˜ˆìš”?"
ë‹¹ì‹ :  "192.168.0.100:8081ì…ë‹ˆë‹¤"

íŒ€ì›B: "HarborëŠ”ìš”?"
ë‹¹ì‹ :  "8080ì…ë‹ˆë‹¤... ì•„ë‹ˆ 8082ì˜€ë‚˜? ì ê¹ë§Œìš”"

íŒ€ì›C: "Sentry ì ‘ì†ì´ ì•ˆë˜ëŠ”ë°ìš”"
ë‹¹ì‹ :  "ì•„ ê·¸ê±° 9090ì¸ë° ì§€ê¸ˆ 9900ìœ¼ë¡œ ì ‘ì†í•˜ê³  ê³„ì‹  ê±° ì•„ë‹ˆì—ìš”?"
```

**íŒ€ ìƒí™© 2: ì‹ ê·œ íŒ€ì› ì˜¨ë³´ë”© (ì…ì‚¬ ì²«ë‚ )**
```
ì‹ ì…: "ê°œë°œ í™˜ê²½ ì ‘ì† ì •ë³´ ì•Œë ¤ì£¼ì„¸ìš”"
ë‹¹ì‹ : "ì—‘ì…€ íŒŒì¼ í•˜ë‚˜ ë³´ë‚´ë“œë¦´ê²Œìš”..."

[Services.xlsx ë‚´ìš©]
ì„œë¹„ìŠ¤ëª…      | ì£¼ì†Œ                    | ìš©ë„
Gitea        | 192.168.0.100:3000    | Git ì €ì¥ì†Œ
Harbor       | 192.168.0.100:8080    | Docker ë ˆì§€ìŠ¤íŠ¸ë¦¬
Nexus        | 192.168.0.100:8081    | NuGet íŒ¨í‚¤ì§€
Grafana      | 192.168.0.100:3001    | ëª¨ë‹ˆí„°ë§
...

ì‹ ì…: "ì´ê±° ë¶ë§ˆí¬ì— ë‹¤ ì¶”ê°€í•´ì•¼ í•˜ë‚˜ìš”?"
ë‹¹ì‹ : "ë„¤... ì €í¬ë„ ê·¸ë ‡ê²Œ ì“°ê³  ìˆì–´ìš”..."
```

**íŒ€ ìƒí™© 3: ì™¸ë¶€ ê³µìœ ê°€ ë¶ˆê°€ëŠ¥**
```
ëŒ€í‘œ: "í˜‘ë ¥ì‚¬ì— ìš°ë¦¬ Git ì €ì¥ì†Œ ì ‘ê·¼ ê¶Œí•œ ì¤˜ì•¼ í•˜ëŠ”ë°"
ë‹¹ì‹ : "http://192.168.0.100:3000 ì•Œë ¤ë“œë¦¬ë©´... ì•ˆë˜ê² ì£ ?"
ëŒ€í‘œ: "...ë‹¹ì—°íˆ ì•ˆë˜ì§€. í¬íŠ¸í¬ì›Œë”©í•´ì„œ ì™¸ë¶€ì—ì„œë„ ì ‘ì† ê°€ëŠ¥í•˜ê²Œ í•´"

ë‹¹ì‹ : (ê³µìœ ê¸° ì„¤ì • í™”ë©´ì„ ì—´ë©°...)
     3000ë²ˆ í¬íŠ¸ â†’ ì™¸ë¶€ 3000ë²ˆ
     8080ë²ˆ í¬íŠ¸ â†’ ì™¸ë¶€ 8080ë²ˆ
     8081ë²ˆ í¬íŠ¸ â†’ ì™¸ë¶€ 8081ë²ˆ
     ...
     "ì´ê±° ë³´ì•ˆìƒ ì§„ì§œ ê´œì°®ì€ ê±´ê°€?"
```

ğŸ’¼ **ì†Œê·œëª¨ ì¡°ì§ ê´€ì  - ë¹„íš¨ìœ¨ì˜ ì‹œì‘**:
- **ì‹œê°„ ë‚­ë¹„**: ì£¼ì†Œ ë¬¼ì–´ë³´ê³  ë‹µí•˜ëŠ”ë° í•˜ë£¨ 10ë¶„ Ã— 20ëª… = 200ë¶„ (3.3ì‹œê°„)
- **ì‹¤ìˆ˜ ë°œìƒ**: ì˜ëª»ëœ í¬íŠ¸ë¡œ ì ‘ì† ì‹œë„ â†’ ì‹œê°„ ë‚­ë¹„
- **ì „ë¬¸ì„± ë¶€ì¡±**: í˜‘ë ¥ì‚¬ë‚˜ íˆ¬ììì—ê²Œ "192.168.0.100:3000" ê³µìœ  ë¶ˆê°€
- **ë³´ì•ˆ ìœ„í—˜**: ëª¨ë“  í¬íŠ¸ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œí•˜ëŠ” ê²ƒì€ ë§¤ìš° ìœ„í—˜

#### 3ë‹¨ê³„: SSL ì¸ì¦ì„œ ê´€ë¦¬ì˜ ì•…ëª½ (ì„œë¹„ìŠ¤ 15ê°œ+)

**ìƒí™© 1: ì™¸ë¶€ ì ‘ì† ìš”êµ¬ì‚¬í•­ ë°œìƒ**

```
ëŒ€í‘œ: "ìš°ë¦¬ ì„œë¹„ìŠ¤ë“¤ ì´ì œ HTTPSë¡œ ì ‘ì†ë˜ê²Œ í•´ì¤˜.
      ê³ ê°ì‚¬ì—ì„œ 'httpëŠ” ì•ˆì „í•˜ì§€ ì•Šë‹¤'ê³  í•˜ë„¤"

ë‹¹ì‹ : (Let's Encrypt ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ë©°...)
     "ì„œë¹„ìŠ¤ë§ˆë‹¤ ê°œë³„ ì¸ì¦ì„œ ë°œê¸‰í•´ì•¼ í•˜ëŠ”ë°..."

í•„ìš”í•œ SSL ì¸ì¦ì„œ:
- gitea.company.com
- harbor.company.com
- nexus.company.com
- grafana.company.com
- sentry.company.com
... (15ê°œ)

ìˆ˜ë™ ë°œê¸‰ ì‹œ:
- ì¸ì¦ì„œ ë°œê¸‰: ì„œë¹„ìŠ¤ë‹¹ 30ë¶„ Ã— 15ê°œ = 7.5ì‹œê°„
- ê°±ì‹ : 90ì¼ë§ˆë‹¤ ë°˜ë³µ (ì—° 4íšŒ)
- ì´ ì—°ê°„ ì†Œìš”: 30ì‹œê°„
```

**ë¹„ìš© ê³„ì‚° (ìƒìš© SSL ì¸ì¦ì„œ ì‚¬ìš© ì‹œ)**:
```
ì¼ë°˜ SSL ì¸ì¦ì„œ: $50/ë…„
15ê°œ ì„œë¹„ìŠ¤ Ã— $50 = $750/ë…„

ì™€ì¼ë“œì¹´ë“œ ì¸ì¦ì„œ: $200/ë…„
í•˜ì§€ë§Œ ì„¤ì • ë³µì¡ë„ â†‘
```

**ìƒí™© 2: í¬íŠ¸ ê´€ë¦¬ì˜ í•œê³„**

```
íŒ€ì›: "ìƒˆ ì„œë¹„ìŠ¤ ë°°í¬í•˜ë ¤ëŠ”ë° í¬íŠ¸ ëª‡ ë²ˆ ì“¸ê¹Œìš”?"
ë‹¹ì‹ : "8083ì€ ì´ë¯¸ ì“°ê³  ìˆê³ ... 8084ë„ ì“°ê³  ìˆê³ ...
      ì—‘ì…€ íŒŒì¼ ë´ì•¼ê² ë‹¤"

[ì‚¬ìš©ì¤‘ì¸ í¬íŠ¸ ë¦¬ìŠ¤íŠ¸]
3000, 3001, 5432, 8080, 8081, 8082, 8089, 8200, 9000, 9090...

ë‹¹ì‹ : "9091 ì“°ì„¸ìš”"
íŒ€ì›: "ì‚¬ìš©ìê°€ ì–´ë–»ê²Œ ì™¸ìš°ë‚˜ìš”?"
ë‹¹ì‹ : "..."
```

**ìƒí™© 3: í˜‘ë ¥ì‚¬ ê³„ì • ë°œê¸‰**

```
í˜‘ë ¥ì‚¬: "ê°œë°œ í™˜ê²½ ì ‘ì† ì •ë³´ ì£¼ì„¸ìš”"

ë‹¹ì‹ ì´ ë³´ë‚´ëŠ” ë©”ì¼:
ì œëª©: ê°œë°œ í™˜ê²½ ì ‘ì† ì •ë³´

Git ì €ì¥ì†Œ: https://git.company.com:3000
Docker ë ˆì§€ìŠ¤íŠ¸ë¦¬: https://harbor.company.com:8080
íŒ¨í‚¤ì§€ ì €ì¥ì†Œ: https://nexus.company.com:8081

â€» ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ í¬íŠ¸ë²ˆí˜¸ê°€ ë‹¤ë¥´ë‹ˆ ì£¼ì˜í•˜ì„¸ìš”
â€» ë¸Œë¼ìš°ì €ì—ì„œ ë³´ì•ˆ ê²½ê³ ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤ (ìì²´ ì¸ì¦ì„œ ì‚¬ìš©)

í˜‘ë ¥ì‚¬: "...ì´ê±° ì •ì‹ ì„œë¹„ìŠ¤ ë§ë‚˜ìš”?"
```

ğŸ’¼ **ì†Œê·œëª¨ ì¡°ì§ ê´€ì  - ì „ë¬¸ì„± ë¶€ì¡±ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ì†ì‹¤**:
- **ì‹ ë¢°ë„ í•˜ë½**: í¬íŠ¸ë²ˆí˜¸ê°€ ë¶™ì€ URLì€ ë¹„ì „ë¬¸ì ìœ¼ë¡œ ë³´ì„
- **ë³´ì•ˆ ê²½ê³ **: ìì²´ ì„œëª… ì¸ì¦ì„œëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ê²½ê³  í‘œì‹œ
- **ê¸°íšŒ ë¹„ìš©**: SSL ê´€ë¦¬ì— ì—°ê°„ 30ì‹œê°„ ì†Œìš” (ê°œë°œì ì¸ê±´ë¹„ ê¸°ì¤€ ì•½ 120ë§Œì›)
- **í˜‘ë ¥ ë‚œí•­**: í˜‘ë ¥ì‚¬ê°€ "ë³´ì•ˆì´ ê±±ì •ëœë‹¤"ë©° ê³„ì•½ ì£¼ì €

#### 4ë‹¨ê³„: Nginx Proxy Manager - ëª¨ë“  ë¬¸ì œ í•œ ë²ˆì— í•´ê²°

**ë„ì… í›„ ë³€í™”**:

| í•­ëª© | ë„ì… ì „ | ë„ì… í›„ | ì‹œê°„ ì ˆì•½ |
|------|---------|---------|-----------|
| ì„œë¹„ìŠ¤ ì ‘ì† | `http://192.168.0.100:8081` | `https://nexus.company.com` | - |
| SSL ì¸ì¦ì„œ ë°œê¸‰ | 30ë¶„/ì„œë¹„ìŠ¤ Ã— 15ê°œ = 7.5ì‹œê°„ | 1ë¶„/ì„œë¹„ìŠ¤ (ìë™) Ã— 15ë¶„ | **7.25ì‹œê°„** |
| SSL ê°±ì‹  | ìˆ˜ë™ (90ì¼ë§ˆë‹¤) | ì™„ì „ ìë™ | **ì—° 28ì‹œê°„** |
| ì‹ ê·œ íŒ€ì› ì˜¨ë³´ë”© | ì—‘ì…€ íŒŒì¼ ê³µìœ , í¬íŠ¸ ì„¤ëª… | ê°„ë‹¨í•œ ë„ë©”ì¸ë§Œ ì•Œë ¤ì£¼ë©´ ë | **ì…ì‚¬ìë‹¹ 30ë¶„** |
| ì™¸ë¶€ í˜‘ë ¥ì‚¬ ê³µìœ  | ë¶ˆê°€ëŠ¥ (í¬íŠ¸ ë…¸ì¶œ ìœ„í—˜) | ì•ˆì „í•˜ê²Œ ê³µìœ  ê°€ëŠ¥ | **ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°íšŒ â†‘** |
| í¬íŠ¸ ê´€ë¦¬ | ì—‘ì…€ë¡œ ìˆ˜ë™ ê´€ë¦¬ | í•„ìš”ì—†ìŒ (ëª¨ë‘ 80/443 í¬íŠ¸) | **ì›” 2ì‹œê°„** |

**ë¹„ìš© ì ˆê° ê³„ì‚°**:

```
ğŸ’° SSL ì¸ì¦ì„œ ë¹„ìš©:
   ìƒìš© ì¸ì¦ì„œ: $750/ë…„ â†’ Let's Encrypt: $0/ë…„
   ì ˆê°: $750/ë…„

ğŸ’° ê°œë°œì ì‹œê°„ ì ˆê°:
   SSL ê´€ë¦¬: 30ì‹œê°„/ë…„ Ã— $40/ì‹œê°„ = $1,200/ë…„
   í¬íŠ¸ ê´€ë¦¬: 24ì‹œê°„/ë…„ Ã— $40/ì‹œê°„ = $960/ë…„
   ì´ ì ˆê°: $2,160/ë…„

ğŸ’° ë¹„ì¦ˆë‹ˆìŠ¤ ì‹ ë¢°ë„:
   ì „ë¬¸ì ì¸ HTTPS URL â†’ í˜‘ë ¥ì‚¬ ì‹ ë¢°ë„ â†‘
   ë¸Œë¼ìš°ì € ë³´ì•ˆ ê²½ê³  ì—†ìŒ â†’ ì‚¬ìš©ì ì´íƒˆë¥  â†“
```

**ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ**:

```
ë„ì… ì „:
- Git: http://192.168.0.100:3000 (í¬íŠ¸ë²ˆí˜¸ ì™¸ì›Œì•¼ í•¨, HTTP ê²½ê³ )
- Harbor: http://192.168.0.100:8080 (Nexusì™€ í¬íŠ¸ í˜¼ë™)
- Nexus: http://192.168.0.100:8081 (ì™¸ë¶€ ê³µìœ  ë¶ˆê°€)

ë„ì… í›„:
- Git: https://git.company.com (SSL ìë™, ì™¸ìš°ê¸° ì‰¬ì›€)
- Harbor: https://harbor.company.com (ì§ê´€ì )
- Nexus: https://nexus.company.com (í˜‘ë ¥ì‚¬ ê³µìœ  ê°€ëŠ¥)

+ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ìë™ìœ¼ë¡œ SSL ì ìš©
+ 90ì¼ë§ˆë‹¤ ì¸ì¦ì„œ ìë™ ê°±ì‹ 
+ ì›¹ UIì—ì„œ í´ë¦­ ëª‡ ë²ˆìœ¼ë¡œ ìƒˆ ì„œë¹„ìŠ¤ ì¶”ê°€
```

ğŸ’¡ **í•µì‹¬ ê°€ì¹˜**:
- **ì‹œê°„ ì ˆì•½**: ì—°ê°„ 84ì‹œê°„ ì ˆì•½ (SSL ê´€ë¦¬ + í¬íŠ¸ ê´€ë¦¬)
- **ë¹„ìš© ì ˆê°**: ì—°ê°„ $2,910 ì ˆê° (ì¸ì¦ì„œ + ì¸ê±´ë¹„)
- **ì „ë¬¸ì„± í–¥ìƒ**: ê¹”ë”í•œ ë„ë©”ì¸ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ì‹ ë¢°ë„ ìƒìŠ¹
- **ë³´ì•ˆ ê°•í™”**: ë‹¨ì¼ ì§„ì…ì ìœ¼ë¡œ ë³´ì•ˆ ê´€ë¦¬ ë‹¨ìˆœí™”
- **í™•ì¥ì„±**: ìƒˆ ì„œë¹„ìŠ¤ ì¶”ê°€ê°€ 1ë¶„ì´ë©´ ê°€ëŠ¥

---

## 5.1 Nginx Proxy Manager ì„¤ì¹˜

[Nginx Proxy Manager](https://nginxproxymanager.com/)ëŠ” ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ì›¹ GUIë¡œ ì‰½ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

### Docker Composeë¡œ ì„¤ì¹˜

`docker-compose.yml`:

```yaml
version: '3.8'

services:
  nginx-proxy-manager:
    image: 'jc21/nginx-proxy-manager:latest'
    container_name: nginx-proxy-manager
    restart: unless-stopped
    ports:
      - '80:80'     # HTTP
      - '443:443'   # HTTPS
      - '81:81'     # Admin Web UI
    environment:
      DB_SQLITE_FILE: "/data/database.sqlite"
    volumes:
      - ./data:/data
      - ./letsencrypt:/etc/letsencrypt
    networks:
      - proxy-network

networks:
  proxy-network:
    driver: bridge
```

```bash
# ì„¤ì¹˜
docker compose up -d

# ë¡œê·¸ í™•ì¸
docker compose logs -f
```

### ì´ˆê¸° ì„¤ì •

1. ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ `http://homeserver:81` ì ‘ì†
2. ê¸°ë³¸ ë¡œê·¸ì¸ ì •ë³´:
   - Email: `admin@example.com`
   - Password: `changeme`
3. ì¦‰ì‹œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
4. ì´ë©”ì¼ ì£¼ì†Œë¥¼ ë³¸ì¸ ê²ƒìœ¼ë¡œ ë³€ê²½

### ì²« í”„ë¡ì‹œ í˜¸ìŠ¤íŠ¸ ì¶”ê°€

1. **Proxy Hosts** â†’ **Add Proxy Host** í´ë¦­
2. ì„¤ì •:
   - Domain Names: `portainer.homelab.local`
   - Scheme: `http`
   - Forward Hostname/IP: `portainer`
   - Forward Port: `9000`
   - Block Common Exploits: âœ“
   - Websockets Support: âœ“

ì´ì œ `http://portainer.homelab.local`ë¡œ Portainerì— ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 5.2 ë„ë©”ì¸ êµ¬ë§¤ì™€ DDNS ì„¤ì •

### DuckDNS í™œìš©ë²•

[DuckDNS](https://www.duckdns.org/)ëŠ” ë¬´ë£Œ DDNS ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

#### 1. DuckDNS ê³„ì • ìƒì„±

1. https://www.duckdns.org/ ë°©ë¬¸
2. GitHub/Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
3. ì›í•˜ëŠ” ì„œë¸Œë„ë©”ì¸ ìƒì„±: `myserver.duckdns.org`
4. í† í° ë³µì‚¬

#### 2. IP ìë™ ì—…ë°ì´íŠ¸ ì„¤ì •

```bash
# DuckDNS ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
mkdir -p ~/scripts
cat > ~/scripts/duckdns-update.sh <<'EOF'
#!/bin/bash
echo url="https://www.duckdns.org/update?domains=myserver&token=YOUR_TOKEN&ip=" | curl -k -o ~/duckdns.log -K -
EOF

chmod +x ~/scripts/duckdns-update.sh

# Cronìœ¼ë¡œ 5ë¶„ë§ˆë‹¤ ì‹¤í–‰
crontab -e
```

Cron í•­ëª© ì¶”ê°€:
```
*/5 * * * * ~/scripts/duckdns-update.sh >/dev/null 2>&1
```

#### Dockerë¡œ ìë™ ì—…ë°ì´íŠ¸

ë” ê°„í¸í•˜ê²Œ Docker ì»¨í…Œì´ë„ˆë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```yaml
services:
  duckdns:
    image: lscr.io/linuxserver/duckdns:latest
    container_name: duckdns
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Seoul
      - SUBDOMAINS=myserver
      - TOKEN=YOUR_DUCKDNS_TOKEN
      - UPDATE_IP=ipv4
    restart: unless-stopped
```

### Cloudflare ì—°ë™

[Cloudflare](https://www.cloudflare.com/)ëŠ” ë¬´ë£Œ CDNê³¼ DNS ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

#### 1. ë„ë©”ì¸ ì¶”ê°€

1. Cloudflare ê°€ì… í›„ ë¡œê·¸ì¸
2. **Add a Site** í´ë¦­
3. ë„ë©”ì¸ ì…ë ¥ (ì˜ˆ: `example.com`)
4. Free í”Œëœ ì„ íƒ
5. ë„¤ì„ì„œë²„ë¥¼ Cloudflare ê²ƒìœ¼ë¡œ ë³€ê²½ (ë„ë©”ì¸ ë“±ë¡ ëŒ€í–‰ì‚¬ì—ì„œ)

#### 2. DNS ë ˆì½”ë“œ ì¶”ê°€

**A ë ˆì½”ë“œ**:
```
Type: A
Name: home
Content: <ì§‘ ê³µì¸ IP>
Proxy status: Proxied (ì£¼í™©ìƒ‰ êµ¬ë¦„)
TTL: Auto
```

**CNAME ë ˆì½”ë“œ**:
```
Type: CNAME
Name: *.home
Content: home.example.com
Proxy status: Proxied
```

ì´ì œ `home.example.com`, `portainer.home.example.com` ë“±ìœ¼ë¡œ ì ‘ì† ê°€ëŠ¥í•©ë‹ˆë‹¤.

#### 3. Cloudflare APIë¡œ ë™ì  IP ì—…ë°ì´íŠ¸

```bash
cat > ~/scripts/cloudflare-ddns.sh <<'EOF'
#!/bin/bash

# Cloudflare ì„¤ì •
CF_API_TOKEN="your_api_token"
ZONE_ID="your_zone_id"
RECORD_NAME="home.example.com"
RECORD_ID="your_record_id"

# í˜„ì¬ ê³µì¸ IP ê°€ì ¸ì˜¤ê¸°
CURRENT_IP=$(curl -s https://api.ipify.org)

# Cloudflare DNS ì—…ë°ì´íŠ¸
curl -X PUT "https://api.cloudflare.com/client/v4/zones/${ZONE_ID}/dns_records/${RECORD_ID}" \
  -H "Authorization: Bearer ${CF_API_TOKEN}" \
  -H "Content-Type: application/json" \
  --data "{\"type\":\"A\",\"name\":\"${RECORD_NAME}\",\"content\":\"${CURRENT_IP}\",\"ttl\":120,\"proxied\":true}"
EOF

chmod +x ~/scripts/cloudflare-ddns.sh
```

## 5.3 SSL ì¸ì¦ì„œ ìë™í™” (Let's Encrypt)

### Nginx Proxy Managerì—ì„œ SSL ì„¤ì •

1. **Proxy Hosts**ì—ì„œ í˜¸ìŠ¤íŠ¸ í¸ì§‘
2. **SSL** íƒ­ìœ¼ë¡œ ì´ë™
3. SSL Certificate: **Request a new SSL Certificate**
4. Email: ë³¸ì¸ ì´ë©”ì¼ ì…ë ¥
5. **I Agree to the Let's Encrypt Terms of Service** ì²´í¬
6. **Force SSL** ì²´í¬
7. **Save** í´ë¦­

ìë™ìœ¼ë¡œ [Let's Encrypt](https://letsencrypt.org/) ì¸ì¦ì„œë¥¼ ë°œê¸‰ë°›ê³  90ì¼ë§ˆë‹¤ ìë™ ê°±ì‹ ë©ë‹ˆë‹¤.

### Wildcard ì¸ì¦ì„œ ë°œê¸‰

ì—¬ëŸ¬ ì„œë¸Œë„ë©”ì¸ì„ ì‚¬ìš©í•œë‹¤ë©´ ì™€ì¼ë“œì¹´ë“œ ì¸ì¦ì„œê°€ í¸ë¦¬í•©ë‹ˆë‹¤.

1. **SSL Certificates** â†’ **Add SSL Certificate**
2. Domain Names: `*.example.com`, `example.com`
3. Email: ë³¸ì¸ ì´ë©”ì¼
4. **Use a DNS Challenge** ì²´í¬
5. DNS Provider: Cloudflare ì„ íƒ
6. Credentials File Content:
```
dns_cloudflare_api_token = your_cloudflare_api_token
```
7. **Save** í´ë¦­

ì´ì œ ëª¨ë“  ì„œë¸Œë„ë©”ì¸ì—ì„œ ë™ì¼í•œ SSL ì¸ì¦ì„œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Certbotìœ¼ë¡œ ì§ì ‘ ê´€ë¦¬ (ê³ ê¸‰)

Nginx Proxy Managerë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°:

```bash
# Certbot ì„¤ì¹˜
sudo apt install certbot python3-certbot-nginx -y

# ì¸ì¦ì„œ ë°œê¸‰
sudo certbot --nginx -d example.com -d www.example.com

# ìë™ ê°±ì‹  í…ŒìŠ¤íŠ¸
sudo certbot renew --dry-run

# Cronìœ¼ë¡œ ìë™ ê°±ì‹  (ì´ë¯¸ ìë™ ì„¤ì •ë¨)
sudo systemctl status certbot.timer
```

## 5.4 ë‚´ë¶€ DNS ì„œë²„ êµ¬ì¶• (Pi-hole)

[Pi-hole](https://pi-hole.net/)ì€ ë„¤íŠ¸ì›Œí¬ ì „ì²´ì˜ ê´‘ê³ ë¥¼ ì°¨ë‹¨í•˜ëŠ” DNS ì„œë²„ì…ë‹ˆë‹¤.

### Dockerë¡œ Pi-hole ì„¤ì¹˜

`docker-compose.yml`:

```yaml
version: '3.8'

services:
  pihole:
    container_name: pihole
    image: pihole/pihole:latest
    ports:
      - "53:53/tcp"
      - "53:53/udp"
      - "67:67/udp"
      - "8089:80/tcp"
    environment:
      TZ: 'Asia/Seoul'
      WEBPASSWORD: 'your_secure_password'
      FTLCONF_LOCAL_IPV4: '192.168.0.100'
      PIHOLE_DNS_: '1.1.1.1;8.8.8.8'
    volumes:
      - './etc-pihole:/etc/pihole'
      - './etc-dnsmasq.d:/etc/dnsmasq.d'
    restart: unless-stopped
```

```bash
docker compose up -d
```

### ê³µìœ ê¸° DNS ì„¤ì • ë³€ê²½

1. ê³µìœ ê¸° ê´€ë¦¬ í˜ì´ì§€ ì ‘ì†
2. **DHCP ì„¤ì •** ë©”ë‰´
3. Primary DNS: `192.168.0.100` (í™ˆì„œë²„ IP)
4. Secondary DNS: `1.1.1.1` (ë°±ì—…ìš©)
5. ì €ì¥ í›„ ì¬ë¶€íŒ…

### Pi-hole ì›¹ ì¸í„°í˜ì´ìŠ¤

- URL: `http://homeserver:8089/admin`
- ë¹„ë°€ë²ˆí˜¸: docker-composeì—ì„œ ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸

### ë¡œì»¬ DNS ë ˆì½”ë“œ ì¶”ê°€

Pi-holeì—ì„œ ë‚´ë¶€ í˜¸ìŠ¤íŠ¸ëª…ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. **Local DNS** â†’ **DNS Records**
2. Domain: `portainer.homelab.local`
3. IP Address: `192.168.0.100`
4. **Add** í´ë¦­

ì´ì œ ë„¤íŠ¸ì›Œí¬ì˜ ëª¨ë“  ê¸°ê¸°ì—ì„œ `portainer.homelab.local`ë¡œ ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### AdLists ì¶”ê°€ (ê´‘ê³  ì°¨ë‹¨ ê°•í™”)

1. **Adlists** ë©”ë‰´
2. ë‹¤ìŒ ë¦¬ìŠ¤íŠ¸ ì¶”ê°€:
   - https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts
   - https://v.firebog.net/hosts/AdguardDNS.txt
   - https://v.firebog.net/hosts/Easylist.txt
3. **Tools** â†’ **Update Gravity** ì‹¤í–‰

### í†µê³„ í™•ì¸

ëŒ€ì‹œë³´ë“œì—ì„œ:
- ì°¨ë‹¨ëœ ê´‘ê³  ìˆ˜
- DNS ì¿¼ë¦¬ í†µê³„
- Top Domains
- Top Blocked Domains

---

**ë‹¤ìŒ ì¥ì—ì„œëŠ”**: Grafana, Prometheus, Netdataë¥¼ í™œìš©í•œ ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§ í™˜ê²½ êµ¬ì¶• ë°©ë²•ì„ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.
